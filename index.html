<!DOCTYPE html>

<html lang="zh-Hant">
<head>
<link href="styles.css" rel="stylesheet"/>
<meta charset="utf-8"/>
<meta content="width=device-width, initial-scale=1" name="viewport"/>
<title>è‡ªç„¶å¤§å” âˆ£ è¨‚å–®æ’ç¨‹ç³»çµ±</title>
<link href="https://res.cloudinary.com/dijzndzw2/image/upload/v1757176751/logo-3_hddq08.png" rel="icon" type="image/png"/>
<script defer="True" src="https://cdn.jsdelivr.net/npm/sweetalert2@11"></script>
<script src="https://cdn.jsdelivr.net/npm/xlsx@0.18.5/dist/xlsx.full.min.js"></script>
<style>
.photo-url-input {
  width: 100%;
  max-width: 520px;
  margin-bottom: 4px;
  padding: 6px 10px;
  border: 1px solid #ccc;
  border-radius: 6px;
}
#photoUrlContainer .photo-row {
  display: flex;
  align-items: center;
  gap: 8px;
}
#addPhotoUrlBtn.btn.btn-blue {
  background-color: #007bff;
  color: white;
  border: none;
  padding: 6px 12px;
  border-radius: 6px;
  cursor: pointer;
}

#photoUrlViewer a {
  word-break: break-all;
  overflow-wrap: anywhere;
  display: block;
}
</style></head>
<body>
<header>
<div class="wrap toolbar">
<div class="pill">
<strong>æœˆä»½</strong>
<select id="yearSel"><option value="è‡ªç„¶å¤§å”"></option></select>
<select id="monthSel"></select>
</div>
<div class="pill">
<strong>ä½œæ¥­äººå“¡</strong>
<select id="staffFilter"></select>
</div>
<div class="pill">
<strong>ç‹€æ³</strong>
<select id="statusFilter">
<option value="">å…¨éƒ¨</option>
<option value="æ’å®š">æ’å®š</option>
<option value="å®Œæˆ">å®Œæˆ</option>
<option value="æœªå®Œæˆ">æœªå®Œæˆ</option>
</select>
</div>
<div class="pill">
<strong>å®Œæˆæ™‚é–“</strong>
<select id="completedRange">
<option value="">å…¨éƒ¨</option>
<option value="7">è¿‘7å¤©</option>
<option value="30">è¿‘30å¤©</option>
</select>
</div>
<label class="pill" style="gap:8px">
<input checked="" id="showUndated" type="checkbox"/>
<span>é¡¯ç¤ºæœªæ’æœŸ</span>
</label>
<div class="pill">
<strong>æœå°‹</strong>
<input id="searchInput" placeholder="å§“å / é›»è©± / åœ°å€" style="width:220px" type="text"/>
</div>
<div class="right"><button class="accent" id="gdriveBackupBtn" onclick="initGoogleBackup()">â˜ï¸Google</button>
<button class="accent" id="newBtn">æ–°å¢è¨‚å–®</button>
<button id="newExpenseBtn">æ–°å¢èŠ±è²»</button>
<button id="exportJson">åŒ¯å‡ºJSON</button>
<button id="exportXlsx">åŒ¯å‡ºExcel</button>
<button class="warn" id="importJson">åŒ¯å…¥JSON</button>
<button class="danger" id="clearAll">æ¸…ç©ºè³‡æ–™</button></div>
</div>
</header>
<main class="wrap stack" style="margin-top:16px">
<!-- è¨‚å–®åˆ—è¡¨ï¼ˆä¸Šï¼‰ -->
<section class="card">
<div class="card-header" style="display:flex; align-items:center; justify-content:space-between;">
<h2>è¨‚å–®åˆ—è¡¨</h2>
<div class="header-actions" style="display:flex; align-items:center; gap:4px; flex-shrink:0;"><select aria-label="çµ±è¨ˆå¹´ä»½é¸æ“‡" id="yearStatSelect" style="height:32px; margin-right:12px; padding:4px 8px; font-size:14px; max-width:120px;"></select>
<button aria-controls="yearSummary" aria-expanded="false" class="small-toggle" id="toggleYearBtn" style=" min-width:80px; white-space:nowrap;" title="åˆ‡æ›å¹´åº¦çµ±è¨ˆ (é è¨­æ”¶èµ·)">
      å¹´åº¦çµ±è¨ˆ â–¾
    </button>
</div>
</div>
<div class="body">
<div style="display:flex; align-items:center; justify-content:space-between; gap:8px; margin-bottom:8px;">
<div></div>
<div style="display:flex; gap:8px; align-items:center;">
</div>
</div>
<div class="sum" id="yearSummary" style="padding-top: 4px; margin-bottom: 16px;"></div>
<div class="sum" id="summary"></div>
<div class="hr"></div>
<div style="overflow:auto;margin-top:8px">
<!-- å¿«åˆ°æœŸæé†’å€å¡Š -->
<div class="card due-panel" id="dueSoonPanel">
<div class="card-title">å¿«åˆ°æœŸæé†’ï¼ˆ30 å¤©å…§ï¼‰</div>
<div class="due-list empty" id="dueSoonList">ç›®å‰æ²’æœ‰ 30 å¤©å…§å°‡åˆ°æœŸçš„å®¢æˆ¶</div>
</div>
<table id="ordersTable">
<thead>
<tr>
<th>#</th>
<th>æ—¥æœŸ</th>
<th>æ™‚é–“</th>
<th>ä½œæ¥­äººå“¡</th>
<th>å®¢æˆ¶</th>
<th>é›»è©±</th>
<th class="col-slot">æ™‚æ®µ</th>
<th>åœ°å€</th>
<th class="col-status">ç‹€æ³</th>
<th>ç¢ºèª</th>
<th>å ±åƒ¹å–®</th>
<th class="right-align col-total">ç¸½é‡‘é¡</th>
<th class="right-align">æŠ˜å¾Œ</th>
<th>ä¾†æº</th>
<th>æ“ä½œ</th>
</tr>
</thead>
<tbody></tbody>
</table>
</div>
</div>
</section>
<!-- è¨‚å–®è¡¨å–®ï¼ˆä¸­ï¼‰ -->
<details class="accordion" id="orderAccordion"><summary><span id="formTitle">æ–°å¢ / ç·¨è¼¯è¨‚å–®</span>
Â Â <button id="toggleLayoutEditBtn" style="font-size:13px;padding:6px 8px;border-radius:6px;margin-left:8px;" type="button">ç·¨è¼¯å¸ƒå±€</button>
<button id="saveLayoutBtn" style="display:none;font-size:13px;padding:6px 8px;border-radius:6px;margin-left:6px;" type="button">å„²å­˜å¸ƒå±€</button>
<button id="resetLayoutBtn" style="display:none;font-size:13px;padding:6px 8px;border-radius:6px;margin-left:6px;" type="button">é‚„åŸé è¨­</button>
</summary><div class="content">
<form id="orderForm">
<input id="id" type="hidden"/>
<div class="row">
<div class="col" style="grid-column:span 6">
<label>ä½œæ¥­äººå“¡</label>
<div class="toolbar" style="gap:8px">
<select id="staff"><option value="é€å¤©å±‹"></option><option value="å¤§æ¨“(æœ‰é›»æ¢¯)"></option><option value="å¤§æ¨“(ç„¡é›»æ¢¯)"></option><option value="å…¶ä»–(å¯è‡ªè¡Œè¼¸å…¥)"></option></select>
<button class="inline-btn" id="addStaffBtn" type="button">æ–°å¢äººå“¡</button>
</div>
</div>
<div class="col" style="grid-column:span 3">
<label>æ—¥æœŸï¼ˆå¯ç•™ç©ºï¼Œä¹‹å¾Œå†å¡«ï¼‰</label>
<input id="date" type="date"/>
</div>
<div class="col" style="grid-column:span 3">
<label>æ™‚é–“</label>
<input id="time" type="time"/>
</div>
<div class="col" style="grid-column:span 7">
<label>æ¸…æ´—åœ°å€</label>
<input id="address" placeholder="åœ°å€" type="text"/>
</div>
</div>
<div class="row">
<div class="col" style="grid-column:span 6">
<label>å§“åï¼ˆæ”¯æ´é€šè¨ŠéŒ„ï¼‰</label>
<input id="customer" list="contactsDL" placeholder="å®¢æˆ¶å§“å" type="text"/>
<datalist id="contactsDL"></datalist>
<div class="tiny">é¸æ—¢æœ‰å®¢æˆ¶æœƒè‡ªå‹•å¸¶å‡ºé›»è©±/åœ°å€</div>
</div>
<div class="col" style="grid-column:span 3">
<label>LINE or Fackbook ID</label>
<input id="lineId" type="text"/>
</div>
<div class="col" style="grid-column:span 3">
<label>é›»è©±</label>
<div id="phoneContainer">
<input class="phone-input" placeholder="è¼¸å…¥é›»è©±" type="text"/>
</div>
<button id="addPhoneBtn" type="button">ï¼‹æ–°å¢é›»è©±</button>
</div>
<div class="col" style="grid-column:span 6">
<label>å±…ä½åœ°å‹æ…‹</label>
<div class="toolbar" style="gap:8px">
<select id="residenceType">
<option value="">ï¼ˆæœªé¸æ“‡ï¼‰</option>
<option value="é€å¤©å±‹">é€å¤©å±‹</option>
<option value="å¤§æ¨“(æœ‰é›»æ¢¯)">å¤§æ¨“(æœ‰é›»æ¢¯)</option>
<option value="å¤§æ¨“(ç„¡é›»æ¢¯)">å¤§æ¨“(ç„¡é›»æ¢¯)</option>
<option value="å…¶ä»–">å…¶ä»–ï¼ˆå¯è‡ªè¡Œè¼¸å…¥ï¼‰</option>
</select>
<input class="hidden" id="residenceOther" placeholder="è«‹è¼¸å…¥å…¶ä»–å‹æ…‹" type="text"/>
</div>
</div>
</div>
<div class="row">
<div class="col" style="grid-column:span 6">
<label>å®‰æ’æ™‚æ®µï¼ˆå¯è¤‡é¸ï¼‰</label>
<div class="checkbox-group" id="slotGroup"></div>
<input class="hidden tiny" id="slotNote" placeholder="è«‹è¼¸å…¥æŒ‡å®šæ—¥æœŸï¼æ™‚æ®µï¼ˆå¦‚ 10/10 ä¸Šåˆ æˆ– 10/12 9:00â€“12:00ï¼‰" type="text"/>
</div>
<div class="col" style="grid-column:span 6">
<label>æ–¹ä¾¿è¯ç¹«æ™‚é–“ï¼ˆå¯è¤‡é¸ï¼‰</label>
<div class="checkbox-group" id="contactTimesGroup"></div>
<input class="hidden tiny" id="contactTimeNote" placeholder="è«‹è¼¸å…¥æŒ‡å®šæ™‚é–“ï¼ˆå¦‚ 9:00â€“12:00 æˆ– é€±ä¸‰æ™šä¸Šï¼‰" type="text"/>
</div>
<div class="col" style="grid-column:span 8">
<label>èˆ‡æˆ‘å¸è¯ç¹«æ–¹å¼</label>
<div class="toolbar" style="gap:8px">
<select id="contactMethod"></select>
<button class="inline-btn" id="addContactMethod" type="button">æ–°å¢è¯ç¹«æ–¹å¼</button>
</div>
</div>
<div class="col" style="grid-column:span 4">
<label>ç‹€æ³</label>
<select id="status">
<option value="æ’å®š">æ’å®š</option>
<option value="å®Œæˆ">å®Œæˆ</option>
<option value="æœªå®Œæˆ">æœªå®Œæˆ</option>
</select>
</div>
</div>
<div class="row">
<div class="col" style="grid-column:span 6">
<label>å†·æ°£ä½æ–¼æ¨“å±¤ï¼ˆå¯è¤‡é¸ï¼‰</label>
<div class="checkbox-group" id="acFloors"></div>
<div class="hidden" id="acFloorAboveWrap"><input id="acFloorAbove" placeholder="è«‹è¼¸å…¥å¯¦éš›æ¨“å±¤ï¼ˆä¾‹ï¼š6Fã€7Fâ€¦ï¼‰" type="text"/></div>
</div>
<div class="col" style="grid-column:span 6">
<label>æ´—è¡£æ©Ÿä½æ–¼æ¨“å±¤ï¼ˆå¯è¤‡é¸ï¼‰</label>
<div class="checkbox-group" id="washerFloors"></div>
<div class="hidden" id="washerFloorAboveWrap"><input id="washerFloorAbove" placeholder="è«‹è¼¸å…¥å¯¦éš›æ¨“å±¤ï¼ˆä¾‹ï¼š6Fã€7Fâ€¦ï¼‰" type="text"/></div>
</div>
<div class="col" style="grid-column:span 6">
<div class="toolbar" id="reminderToolbar" style="gap:8px; align-items:center; flex-wrap:wrap">
<label class="pill"><input checked="" id="reminderEnabled" type="checkbox"/> <span>å•Ÿç”¨æé†’</span></label>
<label class="muted">æé†’é€±æœŸï¼ˆæœˆï¼‰</label>
<input class="tiny compact" id="reminderMonths" min="0" placeholder="ä¾‹å¦‚ 12" step="1" type="number" value="24"/>
<label class="muted">ä¸‹æ¬¡æé†’</label>
<input class="tiny" disabled="" id="nextReminder" type="text"/>
<label class="pill"><input id="reminderNotified" type="checkbox"/> <span>å·²é€šçŸ¥</span></label>
<label class="pill danger"><input type="checkbox" id="reminderMuted"><span>ä¸å†æé†’</span></label>
</div>
</div>
</div>
<div class="hr"></div>
<h3 style="margin:0 0 8px">æ¸…æ´—é …ç›®èˆ‡åƒ¹æ ¼</h3>
<div class="row">
<div class="col" style="grid-column:span 6">
<label><b><span >åˆ†é›¢å¼å†·æ°£å®¤å…§æ©Ÿï¼ˆæ¯å°1800ï¼›æ»¿3å°æ¯å°1500ï¼‰</span></b></label>
<input id="acSplit" min="0" step="1" type="number" value="0"/>
</div>
<div class="col" style="grid-column:span 6">
<label>åŠéš±å¼å†·æ°£ï¼ˆæ¯å°2800ï¼‰</label>
<input id="acDuct" min="0" step="1" type="number" value="0"/>
</div>
</div>
<div class="row">
<div class="col" style="grid-column:span 6">
<label><b><span >ç›´ç«‹å¼æ´—è¡£æ©Ÿï¼ˆæ¯å°2000ï¼›è‹¥åŒå–®å«å†·æ°£å®¤å…§æ©Ÿå‰‡æ¯å°1800ï¼‰</span></b></label>
<input id="washerTop" min="0" step="1" type="number" value="0"/>
</div>
<div class="col" style="grid-column:span 6">
<label>æ°´å¡”ï¼ˆæ¯é¡†1000ï¼‰</label>
<input id="waterTank" min="0" step="1" type="number" value="0"/>
</div>
</div>
<div class="row">
<div class="col" style="grid-column:span 6">
<label>è‡ªä¾†æ°´ç®¡ï¼ˆè‡ªè¨‚é‡‘é¡ï¼Œæœªç¨…ç¸½é¡ï¼‰</label>
<input id="pipesAmount" min="0" step="1" type="number" value="0"/>
</div>
<div class="col" style="grid-column:span 6">
<label><b><span >é˜²éœ‰å™´åŠ‘ï¼ˆæ¯å°300ï¼›æ»¿5å°æ¯å°250ï¼‰</span></b></label>
<input id="antiMold" min="0" step="1" type="number" value="0"/>
</div>
</div>
<div class="row">
<div class="col" style="grid-column:span 6">
<label>è‡­æ°§æ®ºèŒï¼ˆæ¯é–“200ï¼‰</label>
<input id="ozone" min="0" step="1" type="number" value="0"/>
</div>
<div class="col" style="grid-column:span 6">
<label>è®Šå½¢é‡‘å‰›æ©Ÿå‹ï¼ˆæ¯å°åŠ 500ï¼‰</label>
<input id="transformerCount" min="0" step="1" type="number" value="0"/>
</div>
</div>
<div class="row">
<div class="col" style="grid-column:span 6">
<label>åˆ†é›¢å¼å®¤å…§æ©Ÿé•·åº¦ &gt; 182cmï¼ˆæ¯å°åŠ 300ï¼‰</label>
<input id="longSplitCount" min="0" step="1" type="number" value="0"/>
</div>
<div class="col" style="grid-column:span 6">
<label>ä¸€é«”å¼æ°´ç›¤ï¼ˆæ¯å°åŠ 500ï¼‰</label>
<input id="onePieceTray" min="0" step="1" type="number" value="0"/>
</div>
</div>
<div class="row">
<div class="col" style="grid-column:span 12">
<label>å‚™è¨»</label>
<textarea id="note" placeholder="å…¶ä»–è£œå……äº‹é …"></textarea>
</div>
</div>

<div class="row">
  <div class="col" style="grid-column:span 12">
    <label>é ç´„å†·æ°£å“ç‰Œï¼ˆå¯è¤‡é¸ï¼‰</label>
    <div class="checkbox-group" id="acBrandGroup"></div>
    <input class="hidden tiny" id="acBrandOtherText" placeholder="è«‹è¼¸å…¥å…¶ä»–å“ç‰Œ" type="text"/>
  </div>
</div>
<div class="row"><div class="col" style="grid-column:span 6"><label>æ¸…æ´—ç…§ç‰‡ç¶²å€ï¼ˆå¯å¤šç­†ï¼‰</label><div id="photoUrlContainer"></div><div id="photoUrlViewer" style="display:none; margin-top: 4px;"></div><button id="editPhotoUrlsBtn" onclick="enablePhotoUrlEdit()"  type="button">âœï¸ ç·¨è¼¯ç¶²å€</button><button class="btn btn-blue" id="addPhotoUrlBtn" style="margin-top: 4px; margin-bottom: 4px;" type="button">ï¼‹æ–°å¢ç¶²å€</button><div class="tiny">è²¼å…¥ç¶²å€ï¼Œå®Œæˆå¾Œå¯é»é¸é–‹å•Ÿæ¸…æ´—å‰å¾Œç…§ç‰‡é é¢</div></div></div>
<div class="hr"></div>
<div class="row">
<div class="col" style="grid-column:span 4">
<!-- æ”¹ç‚ºå¯é»æ“Šæ•´å€å¡Šçš„ checkbox (big-toggle) -->
<label class="big-toggle" for="confirmed">
  <input id="confirmed" name="confirmed" type="checkbox" aria-label="å®¢äººç¢ºèªå®‰æ’æ™‚é–“" />
  <span class="big-toggle-text">å®¢äººç¢ºèªå®‰æ’æ™‚é–“</span>
</label>
</div>
<div class="col" style="grid-column:span 4">
<label class="big-toggle" for="quotationOk">
  <input id="quotationOk" name="quotationOk" type="checkbox" aria-label="å®¢äººç¢ºèªå ±åƒ¹å–®" />
  <span class="big-toggle-text">å®¢äººç¢ºèªå ±åƒ¹å–®</span>
</label>
</div>
<div class="col right-align" style="grid-column:span 4">
<button class="inline-btn" id="recalc" type="button">é‡æ–°è¨ˆç®—é‡‘é¡</button>
</div>
</div>
<div class="row">
<div class="col" style="grid-column:span 3">
<label>ç¸½é‡‘é¡ï¼ˆè‡ªå‹•ï¼‰</label>
<input id="total" readonly="" type="number"/>
</div>
<div class="col" style="grid-column:span 3">
<label>é¡å¤–åŠ åƒ¹ï¼ˆæ‰‹å‹•è¼¸å…¥ï¼‰</label>
<input id="extraCharge" min="0" step="1" type="number" value="0"/>
</div>
<div class="col" style="grid-column:span 3">
<label>æŠ˜æ‰£é‡‘é¡ï¼ˆå¯è¼¸å…¥ï¼‰</label>
<input id="discount" min="0" step="1" type="number" value="0"/>
</div>
<div class="col" style="grid-column:span 3">
<label>æŠ˜å¾Œç¸½é‡‘é¡ï¼ˆè‡ªå‹•ï¼‰</label>
<input id="netTotal" readonly="" type="number"/>
</div>
</div>
<div class="hr"></div>
<div class="toolbar">
<button class="primary" id="saveBtn" type="submit">å„²å­˜è¨‚å–®</button>
<button id="resetBtn" type="button">æ¸…ç©ºè¡¨å–®</button>
<button id="copyLastBtn" type="button">è¤‡è£½ä¸Šä¸€ç­†</button>
<button id="copyFromHistoryBtn" type="button">å¾å®¢æˆ¶èˆŠå–®å¸¶å…¥</button>
<div class="right">
<span class="lock-badge" id="lockInfo"></span>
<div style="display:inline-block; margin-right:8px;"><label style="margin-right:4px;">æ™‚é•·(åˆ†)</label><input id="durationMinutes" min="15" placeholder="åˆ†é˜" step="15" style="width:80px;" type="number"/></div><button class="btn" onclick="handleUploadWithAuth(gatherForm())">ğŸ“…</button><button class="warn" id="toggleLock" type="button">è§£é–é‡‘é¡ç·¨è¼¯</button>
<button class="danger" disabled="" id="deleteBtn" type="button">åˆªé™¤æ­¤è¨‚å–®</button>
</div>
</div>
</form>
</div></details>
<!-- æ”¯å‡ºæ¨¡çµ„ï¼ˆä¸‹ï¼‰ä»¥æ‰‹é¢¨ç´å‘ˆç¾ -->
<details =""="" class="accordion" id="expenseAcc">
<summary>æœ¬æœˆèŠ±è²»ï¼ˆå¯å±•é–‹/æ”¶åˆï¼‰</summary>
<div class="content">
<div class="two-col">
<section class="card" style="border:none;box-shadow:none">
<h2>æœ¬æœˆèŠ±è²»åˆ—è¡¨</h2>
<div class="body">
<div class="toolbar" style="margin-bottom:8px">
<button id="expExportCsv">åŒ¯å‡ºèŠ±è²»CSV</button>
<button id="expExportJson">åŒ¯å‡ºèŠ±è²»JSON</button>
<button class="warn" id="expImportJson">åŒ¯å…¥èŠ±è²»JSON</button>
<button class="danger" id="expClear">æ¸…ç©ºèŠ±è²»</button>
</div>
<div style="overflow:auto">
<table id="expenseTable">
<thead>
<tr>
<th>#</th>
<th>æ—¥æœŸ</th>
<th>é¡åˆ¥</th>
<th>èªªæ˜</th>
<th class="right-align">é‡‘é¡</th>
</tr>
</thead>
<tbody></tbody>
</table>
</div>
</div>
</section>
<aside class="card" style="border:none;box-shadow:none">
<h2>æ–°å¢ / ç·¨è¼¯èŠ±è²»</h2>
<div class="body">
<form id="expenseForm">
<input id="expId" type="hidden"/>
<div class="row">
<div class="col" style="grid-column:span 4">
<label>æ—¥æœŸ</label>
<input id="expDate" type="date"/>
</div>
<div class="col" style="grid-column:span 4">
<label>é¡åˆ¥</label>
<div class="toolbar" style="gap:8px">
<select id="expCategory"></select>
<button class="inline-btn" id="addExpCat" type="button">æ–°å¢é¡åˆ¥</button>
</div>
</div>
<div class="col" style="grid-column:span 4">
<label>é‡‘é¡</label>
<input id="expAmount" min="0" step="1" type="number" value="0"/>
</div>
</div>
<div class="row">
<div class="col" style="grid-column:span 12">
<label>èªªæ˜</label>
<input id="expNote" placeholder="ä¾‹å¦‚ï¼šææ–™ã€åŠ æ²¹ã€åœè»Šã€å·¥å…·ç¶­ä¿®â€¦" type="text"/>
</div>
</div>
<div class="toolbar">
<button class="primary" id="expSave" type="submit">å„²å­˜èŠ±è²»</button>
<button id="expReset" type="button">æ¸…ç©ºè¡¨å–®</button>
<div class="right">
<button class="danger" disabled="" id="expDelete" type="button">åˆªé™¤æ­¤ç­†èŠ±è²»</button>
</div>
</div>
</form>
</div>
</aside>
</div>
</div>
</details>
<!-- éœéŸ³åå–®ï¼ˆé è¨­æ”¶åˆï¼‰ -->
<section class="card" id="muteListSection">
<details id="muteCollapse">
<summary class="ab-summary"><h2>éœéŸ³åå–®</h2><span class="hint">(é è¨­æ”¶åˆï¼Œæ‰‹å‹•å±•é–‹)</span></summary>
<div class="body">
<div class="ab-toolbar">
<input id="muteSearch" placeholder="æœå°‹ï¼šå§“å / é›»è©± / å‚™è¨»" type="search"/>
</div>
<div class="ab-table-wrap">
<table class="ab-table" id="muteTable">
<thead>
<tr>
<th>å§“å</th>
<th>é›»è©±</th>
<th>åœ°å€</th>
<th style="width:120px;">ç‹€æ…‹</th>
<th style="width:120px;">æ“ä½œ</th>
</tr>
</thead>
<tbody></tbody>
</table>
</div>
</div>
</details>
</section>
</main>
<input accept=".json" class="hidden" id="filePicker" type="file"/>
<input accept=".json" class="hidden" id="filePickerExp" type="file"/>
<template id="expRowTpl">
<tr>
<td class="small muted"></td>
<td></td><td></td><td></td><td class="right-align"></td>
</tr>
</template>
<script src="https://apis.google.com/js/api.js"></script>
<div>
<!-- âœ… è¼‰å…¥ Google OAuth SDK -->
<script async="" defer="" src="https://accounts.google.com/gsi/client"></script>
<!-- âœ… åŠ åœ¨ refreshTable çš„æ¯ç­†è¨‚å–®æ“ä½œæ¬„ä½ä¸­ -->
<!-- âœ… è¡¨å–®ä¸­æ–°å¢ï¼šå·¥ä½œæ™‚é•·æ¬„ä½ -->
<!-- âœ… gatherForm() ä¸­è£œä¸Š -->
</div>
<script defer="" src="app.js"></script>
<!-- Customer History Modal (added by assistant) -->
<div aria-hidden="true" class="modal" id="historyModal">
<div class="modal-backdrop" data-close="true"></div>
<div class="modal-panel">
<header class="modal-header">
<h3 id="historyModalTitle">å®¢æˆ¶æ­·å²ç´€éŒ„</h3>
<button aria-label="é—œé–‰" class="btn-small" id="historyCloseBtn">âœ•</button>
</header>
<section class="modal-body">
<div class="history-controls">
<input id="historySearch" placeholder="æœå°‹æ¸…æ´—é …ç›®æˆ–å‚™è¨»..."/>
<button class="btn-small" id="historyExportCsv">åŒ¯å‡º CSV</button>
<select id="historySort">
<option value="desc">ä¾æ™‚é–“ï¼ˆæ–°â†’èˆŠï¼‰</option>
<option value="asc">ä¾æ™‚é–“ï¼ˆèˆŠâ†’æ–°ï¼‰</option>
</select>
</div>
<div class="history-table-wrap">
<table class="table" id="historyTable">
<thead>
<tr>
<th>æ¸…æ´—æ™‚é–“</th>
<th>æ¸…æ´—é …ç›®</th>
<th>ç‹€æ…‹</th>
<th>å‚™è¨»</th>
<th>æ“ä½œ</th>
</tr>
</thead>
<tbody id="historyTableBody"></tbody>
</table>
<div id="historyEmpty" style="display:none">ç›®å‰æ²’æœ‰æ­·å²ç´€éŒ„</div>
</div>
</section>
</div>
</div>
<!-- End Customer History Modal -->

<!-- assistant-added: sync .checked class for big-toggle labels (fallback for browsers without :has) -->
<script>
(function(){
  try {
    const labels = document.querySelectorAll('.big-toggle');
    labels.forEach(label => {
      const input = label.querySelector('input[type="checkbox"]');
      if (!input) return;
      const sync = () => label.classList.toggle('checked', !!input.checked);
      sync();
      input.addEventListener('change', sync);
      // also sync on any programmatic changes if needed
      const observer = new MutationObserver(sync);
      observer.observe(input, { attributes: true, attributeFilter: ['checked'] });
    });
  } catch(e){
    console.warn('big-toggle sync failed', e);
  }
})();
</script>
<!-- /assistant-added -->


<script>
/* Inline fallback: ensure danger pill has click behavior and toggles .on class.
   This runs immediately and is robust for file:// scenarios.
*/
(function(){
  function attachAll(){
    var pills = document.querySelectorAll('label.pill, .pill');
    pills.forEach(function(lbl){
      // normalize to label
      if(lbl.tagName.toLowerCase() !== 'label'){
        // wrap?
      }
      // ensure span exists
      var span = lbl.querySelector('span');
      if(!span) {
        span = document.createElement('span');
        span.textContent = lbl.innerText || '';
        // clear text nodes
        lbl.textContent = '';
        lbl.appendChild(span);
      }
      // ensure input exists
      var cb = lbl.querySelector('input[type=checkbox]');
      if(!cb){
        cb = document.createElement('input');
        cb.type = 'checkbox';
        cb.style.position='absolute';
        cb.style.opacity='0';
        cb.style.pointerEvents='none';
        lbl.insertBefore(cb, lbl.firstChild);
      }
      // initial state
      if(cb.checked) lbl.classList.add('on'); else lbl.classList.remove('on');
      // click behavior
      if(!lbl.__pill_attached){
        lbl.addEventListener('click', function(e){
          if(e.target.tagName.toLowerCase() === 'input') return;
          cb.checked = !cb.checked;
          var ev = new Event('change',{bubbles:true});
          cb.dispatchEvent(ev);
          if(cb.checked) lbl.classList.add('on'); else lbl.classList.remove('on');
        });
        cb.addEventListener('change', function(){ if(cb.checked) lbl.classList.add('on'); else lbl.classList.remove('on'); });
        lbl.__pill_attached = true;
      }
    });
  }
  if(document.readyState === 'loading') document.addEventListener('DOMContentLoaded', attachAll); else attachAll();
})();
</script>
</body>

</html>
<!-- åŠ å…¥ Google API SDK -->
<script async="" defer="" src="https://accounts.google.com/gsi/client"></script>
